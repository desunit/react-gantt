"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=require("react/jsx-runtime"),e=require("react"),he=require("@svar-ui/react-core"),be=require("@svar-ui/lib-dom"),Oe=require("@svar-ui/gantt-locales"),Xe=require("@svar-ui/core-locales"),lt=require("@svar-ui/lib-state"),de=require("@svar-ui/gantt-store"),y=require("@svar-ui/lib-react"),st=require("@svar-ui/grid-store"),nt=require("@svar-ui/react-grid"),ct=require("react-dom"),Ze=require("@svar-ui/react-toolbar"),it=require("@svar-ui/react-menu"),De=require("@svar-ui/react-editor"),Ae=e.createContext(null);function He(s){const n=s.getAttribute("data-id"),r=parseInt(n);return isNaN(r)||r.toString()!=n?n:r}function at(s,n,r){const a=s.getBoundingClientRect(),c=n.querySelector(".wx-body").getBoundingClientRect();return{top:a.top-c.top,left:a.left-c.left,dt:a.bottom-r.clientY,db:r.clientY-a.top}}function Je(s){return s&&s.getAttribute("data-context-id")}const et=5;function ut(s,n){let r,a,c,R,l,w,g,k,d;function $(p){R=p.clientX,l=p.clientY,w={...at(r,s,p),y:n.getTask(c).$y},document.body.style.userSelect="none"}function z(p){r=be.locate(p),Je(r)&&(c=He(r),d=setTimeout(()=>{k=!0,n&&n.touchStart&&n.touchStart(),$(p.touches[0])},500),s.addEventListener("touchmove",H),s.addEventListener("contextmenu",E),window.addEventListener("touchend",K))}function E(p){if(k||d)return p.preventDefault(),!1}function _(p){p.which===1&&(r=be.locate(p),Je(r)&&(c=He(r),s.addEventListener("mousemove",X),window.addEventListener("mouseup",v),$(p)))}function u(p){s.removeEventListener("mousemove",X),s.removeEventListener("touchmove",H),document.body.removeEventListener("mouseup",v),document.body.removeEventListener("touchend",K),document.body.style.userSelect="",p&&(s.removeEventListener("mousedown",_),s.removeEventListener("touchstart",z))}function A(p){const O=p.clientX-R,Z=p.clientY-l;if(!a){if(Math.abs(O)<et&&Math.abs(Z)<et||n&&n.start&&n.start({id:c,e:p})===!1)return;a=r.cloneNode(!0),a.style.pointerEvents="none",a.classList.add("wx-reorder-task"),a.style.position="absolute",a.style.left=w.left+"px",a.style.top=w.top+"px",r.style.visibility="hidden",r.parentNode.insertBefore(a,r)}if(a){const se=Math.round(Math.max(0,w.top+Z));if(n&&n.move&&n.move({id:c,top:se,detail:g})===!1)return;const Y=n.getTask(c),L=Y.$y;if(!w.start&&w.y==L)return P();w.start=!0,w.y=Y.$y-4,a.style.top=se+"px";const re=document.elementFromPoint(p.clientX,p.clientY),b=be.locate(re);if(b&&b!==r){const T=He(b),I=b.getBoundingClientRect(),Q=I.top+I.height/2,oe=p.clientY+w.db>Q&&b.nextElementSibling!==r,J=p.clientY-w.dt<Q&&b.previousElementSibling!==r;g?.after==T||g?.before==T?g=null:oe?g={id:c,after:T}:J&&(g={id:c,before:T})}}}function X(p){A(p)}function H(p){k?(p.preventDefault(),A(p.touches[0])):d&&(clearTimeout(d),d=null)}function K(){k=null,d&&(clearTimeout(d),d=null),P()}function v(){P()}function P(){r&&(r.style.visibility=""),a&&(a.parentNode.removeChild(a),n&&n.end&&n.end({id:c,top:w.top})),c=r=a=w=g=null,u()}return s.style.position!=="absolute"&&(s.style.position="relative"),s.addEventListener("mousedown",_),s.addEventListener("touchstart",z),{destroy(){u(!0)}}}function dt({row:s,column:n}){function r(c,R){return{justifyContent:R.align,paddingLeft:`${(c.$level-1)*20}px`}}const a=n&&n._cell;return o.jsxs("div",{className:"wx-pqc08MHU wx-content",style:r(s,n),children:[s.data||s.lazy?o.jsx("i",{className:`wx-pqc08MHU wx-toggle-icon wxi-menu-${s.open?"down":"right"}`,"data-action":"open-task"}):o.jsx("i",{className:"wx-pqc08MHU wx-toggle-placeholder"}),o.jsx("div",{className:"wx-pqc08MHU wx-text",children:a?o.jsx(a,{row:s,column:n}):s.text})]})}function tt({column:s,cell:n}){const r=e.useMemo(()=>s.id,[s?.id]);return n||s.id=="add-task"?o.jsx("div",{style:{textAlign:s.align},children:o.jsx("i",{className:"wx-9DAESAHW wx-action-icon wxi-plus","data-action":r})}):null}function ft(s){const{readonly:n,compactMode:r,width:a=0,display:c="all",columnWidth:R=0,onTableAPIChange:l,multiTaskRows:w=!1,rowMapping:g=null}=s,[k,d]=y.useWritableProp(R),[$,z]=e.useState(),E=e.useContext(he.context.i18n),_=e.useMemo(()=>E.getGroup("gantt"),[E]),u=e.useContext(Ae),A=y.useStore(u,"scrollTop"),X=y.useStore(u,"cellHeight"),H=y.useStore(u,"_scrollTask"),K=y.useStore(u,"_selected"),v=y.useStore(u,"area"),P=y.useStore(u,"_tasks"),p=y.useStore(u,"_scales"),O=y.useStore(u,"columns"),Z=y.useStore(u,"_sort"),se=y.useStore(u,"calendar"),Y=y.useStore(u,"durationUnit"),L=y.useStore(u,"splitTasks"),[re,b]=e.useState(null),T=e.useMemo(()=>!P||!v?[]:P.slice(v.start,v.end),[P,v]),I=e.useCallback((i,h)=>{if(h==="add-task")u.exec(h,{target:i,task:{text:_("New Task")},mode:"child",show:!0});else if(h==="open-task"){const S=T.find(q=>q.id===i);(S?.data||S?.lazy)&&u.exec(h,{id:i,mode:!S.open})}},[T]),Q=e.useCallback(i=>{const h=be.locateID(i),S=i.target.dataset.action;S&&i.preventDefault(),h?S==="add-task"||S==="open-task"?I(h,S):u.exec("select-task",{id:h,toggle:i.ctrlKey||i.metaKey,range:i.shiftKey,show:!0}):S==="add-task"&&I(null,S)},[u,I]),oe=e.useRef(null),J=e.useRef(null),[ie,U]=e.useState(0),[f,G]=e.useState(!1);e.useEffect(()=>{const i=J.current;if(!i||typeof ResizeObserver>"u")return;const h=()=>U(i.clientWidth);h();const S=new ResizeObserver(h);return S.observe(i),()=>S.disconnect()},[]);const W=e.useRef(null),ee=e.useCallback(i=>{const h=i.id,{before:S,after:q}=i,xe=i.onMove;let ue=S||q,ve=S?"before":"after";if(xe){if(ve==="after"){const Me=u.getTask(ue);Me.data?.length&&Me.open&&(ve="before",ue=Me.data[0].id)}W.current={id:h,[ve]:ue}}else W.current=null;u.exec("move-task",{id:h,mode:ve,target:ue,inProgress:xe})},[u]),F=e.useMemo(()=>v?.from??0,[v]),ne=e.useMemo(()=>p?.height??0,[p]),ge=e.useMemo(()=>!r&&c!=="grid"?(k??0)>(a??0):(k??0)>(ie??0),[r,c,k,a,ie]),ye=e.useMemo(()=>{const i={};return ge&&c==="all"||c==="grid"&&ge?i.width=k:c==="grid"&&(i.width="100%"),i},[ge,c,k]),j=e.useMemo(()=>re&&!T.find(i=>i.id===re.id)?[...T,re]:T,[T,re]),V=e.useMemo(()=>{if(!w||!g)return j;const i=new Map,h=new Set;return j.forEach(S=>{const q=g.taskRows.get(S.id)??S.id;h.has(q)||(i.set(q,{...S,$rowTasks:g.rowMap.get(q)||[S.id]}),h.add(q))}),Array.from(i.values())},[j,w,g]),fe=e.useMemo(()=>{let i=(O||[]).map(q=>{q={...q};const xe=q.header;if(typeof xe=="object"){const ue=xe.text&&_(xe.text);q.header={...xe,text:ue}}else q.header=_(xe);return q});const h=i.findIndex(q=>q.id==="text"),S=i.findIndex(q=>q.id==="add-task");if(h!==-1&&(i[h].cell&&(i[h]._cell=i[h].cell),i[h].cell=dt),S!==-1){i[S].cell=i[S].cell||tt;const q=i[S].header;if(typeof q!="object"&&(i[S].header={text:q}),i[S].header.cell=q.cell||tt,n)i.splice(S,1);else if(r){const[xe]=i.splice(S,1);i.unshift(xe)}}return i.length>0&&(i[i.length-1].resize=!1),i},[O,_,n,r]),ke=e.useMemo(()=>c==="all"?`${a}px`:c==="grid"?"calc(100% - 4px)":fe.find(i=>i.id==="add-task")?"50px":"0",[c,a,fe]),Ce=e.useMemo(()=>{if(V&&Z?.length){const i={};return Z.forEach(({key:h,order:S},q)=>{i[h]={order:S,...Z.length>1&&{index:q}}}),i}return{}},[V,Z]),Te=e.useCallback(()=>fe.some(i=>i.flexgrow&&!i.hidden),[]),Se=e.useMemo(()=>Te(),[Te,f]),Re=e.useMemo(()=>{let i=c==="chart"?fe.filter(S=>S.id==="add-task"):fe;const h=c==="all"?a:ie;if(!Se){let S=k,q=!1;if(fe.some(xe=>xe.$width)){let xe=0;S=fe.reduce((ue,ve)=>(ve.hidden||(xe+=ve.width,ue+=ve.$width||ve.width),ue),0),xe>S&&S>h&&(q=!0)}if(q||S<h){let xe=1;return q||(xe=(h-50)/(S-50||1)),i.map(ue=>(ue.id!=="add-task"&&!ue.hidden&&(ue.$width||(ue.$width=ue.width),ue.width=ue.$width*xe),ue))}}return i},[c,fe,Se,k,a,ie]),ce=e.useCallback(i=>{if(!Te()){const h=Re.reduce((S,q)=>(i&&q.$width&&(q.$width=q.width),S+(q.hidden?0:q.width)),0);h!==k&&d(h)}G(!0),G(!1)},[Te,Re,k,d]),x=e.useCallback(()=>{fe.filter(h=>h.flexgrow&&!h.hidden).length===1&&fe.forEach(h=>{h.$width&&!h.flexgrow&&!h.hidden&&(h.width=h.$width)})},[]),B=e.useCallback(i=>{if(!n){const h=be.locateID(i),S=be.locateAttr(i,"data-col-id");!(S&&fe.find(xe=>xe.id==S))?.editor&&h&&u.exec("show-editor",{id:h})}},[u,n]),ae=e.useMemo(()=>Array.isArray(K)?K.map(i=>i.id):[],[K]),M=e.useCallback(()=>{if(oe.current&&V!==null){const i=oe.current.querySelector(".wx-body");i&&(i.style.top=-((A??0)-(F??0))+"px")}J.current&&(J.current.scrollTop=0)},[V,A,F]);e.useEffect(()=>{oe.current&&M()},[A,F,M]),e.useEffect(()=>{const i=oe.current;if(!i)return;const h=i.querySelector(".wx-table-box .wx-body");if(!h||typeof ResizeObserver>"u")return;const S=new ResizeObserver(()=>{M()});return S.observe(h),()=>{S.disconnect()}},[Re,ye,c,ke,V,M]),e.useEffect(()=>{if(!H||!$)return;const{id:i}=H,h=$.getState().focusCell;h&&h.row!==i&&oe.current&&oe.current.contains(document.activeElement)&&$.exec("focus-cell",{row:i,column:h.column})},[H,$]);const pe=e.useCallback(({id:i})=>{if(n)return!1;u.getTask(i).open&&u.exec("open-task",{id:i,mode:!1});const h=u.getState()._tasks.find(S=>S.id===i);if(b(h||null),!h)return!1},[u,n]),Le=e.useCallback(({id:i,top:h})=>{W.current?ee({...W.current,onMove:!1}):u.exec("drag-task",{id:i,top:h+(F??0),inProgress:!1}),b(null)},[u,ee,F]),ze=e.useCallback(({id:i,top:h,detail:S})=>{S&&ee({...S,onMove:!0}),u.exec("drag-task",{id:i,top:h+(F??0),inProgress:!0})},[u,ee,F]);e.useEffect(()=>{const i=oe.current;return i?ut(i,{start:pe,end:Le,move:ze,getTask:u.getTask}).destroy:void 0},[u,pe,Le,ze]);const Ie=e.useCallback(i=>{const{key:h,isInput:S}=i;if(!S&&(h==="arrowup"||h==="arrowdown"))return i.eventSource="grid",u.exec("hotkey",i),!1;if(h==="enter"){const q=$?.getState().focusCell;if(q){const{row:xe,column:ue}=q;ue==="add-task"?I(xe,"add-task"):ue==="text"&&I(xe,"open-task")}}},[u,I,$]),je=e.useRef(null),Ge=()=>{je.current={setTableAPI:z,handleHotkey:Ie,sortVal:Z,api:u,adjustColumns:x,setColumnWidth:ce,tasks:T,calendarVal:se,durationUnitVal:Y,splitTasksVal:L,onTableAPIChange:l}};Ge(),e.useEffect(()=>{Ge()},[z,Ie,Z,u,x,ce,T,se,Y,L,l]);const Ye=e.useCallback(i=>{z(i),i.intercept("hotkey",h=>je.current.handleHotkey(h)),i.intercept("scroll",()=>!1),i.intercept("select-row",()=>!1),i.intercept("sort-rows",h=>{const S=je.current.sortVal,{key:q,add:xe}=h,ue=S?S.find(Me=>Me.key===q):null;let ve="asc";return ue&&(ve=!ue||ue.order==="asc"?"desc":"asc"),u.exec("sort-tasks",{key:q,order:ve,add:xe}),!1}),i.on("resize-column",()=>{je.current.setColumnWidth(!0)}),i.on("hide-column",h=>{h.mode||je.current.adjustColumns(),je.current.setColumnWidth()}),i.intercept("update-cell",h=>{const{id:S,column:q,value:xe}=h,ue=je.current.tasks.find(ve=>ve.id===S);if(ue){const ve={...ue};let Me=xe;Me&&!isNaN(Me)&&!(Me instanceof Date)&&(Me*=1),ve[q]=Me,de.prepareEditTask(ve,{calendar:je.current.calendarVal,durationUnit:je.current.durationUnitVal,splitTasks:je.current.splitTasksVal},q),u.exec("update-task",{id:S,task:ve})}return!1}),l&&l(i)},[]);return o.jsx("div",{className:"wx-rHj6070p wx-table-container",style:{flex:`0 0 ${ke}`},ref:J,children:o.jsx("div",{ref:oe,style:ye,className:"wx-rHj6070p wx-table",onClick:Q,onDoubleClick:B,children:o.jsx(nt.Grid,{init:Ye,sizes:{rowHeight:X,headerHeight:(ne??0)-1},rowStyle:i=>i.$reorder?"wx-rHj6070p wx-reorder-task":"wx-rHj6070p",columnStyle:i=>`wx-rHj6070p wx-text-${i.align}${i.id==="add-task"?" wx-action":""}`,data:V,columns:Re,selectedRows:[...ae],sortMarks:Ce})})})}function xt({borders:s=""}){const n=e.useContext(Ae),r=y.useStore(n,"cellWidth"),a=y.useStore(n,"cellHeight"),c=e.useRef(null),[R,l]=e.useState("#e4e4e4");e.useEffect(()=>{if(typeof getComputedStyle<"u"&&c.current){const g=getComputedStyle(c.current).getPropertyValue("--wx-gantt-border");l(g?g.substring(g.indexOf("#")):"#1d1e261a")}},[]);const w={width:"100%",height:"100%",background:r!=null&&a!=null?`url(${de.grid(r,a,R,s)})`:void 0,position:"absolute"};return o.jsx("div",{ref:c,style:w})}function mt({onSelectLink:s,selectedLink:n,readonly:r}){const a=e.useContext(Ae),c=y.useStore(a,"_links"),R=y.useStore(a,"criticalPath"),l=e.useRef(null),w=e.useCallback(g=>{const k=g?.target?.classList;!k?.contains("wx-line")&&!k?.contains("wx-delete-button")&&s(null)},[s]);return e.useEffect(()=>{if(!r&&n&&l.current){const g=k=>{l.current&&!l.current.contains(k.target)&&w(k)};return document.addEventListener("click",g),()=>{document.removeEventListener("click",g)}}},[r,n,w]),o.jsxs("svg",{className:"wx-dkx3NwEn wx-links",children:[(c||[]).map(g=>{const k="wx-dkx3NwEn wx-line"+(R&&g.$critical?" wx-critical":"")+(r?"":" wx-line-selectable");return o.jsx("polyline",{className:k,points:g.$p,onClick:()=>!r&&s(g.id),"data-link-id":g.id},g.id)}),!r&&n&&o.jsx("polyline",{ref:l,className:"wx-dkx3NwEn wx-line wx-line-selected wx-line-selectable wx-delete-link",points:n.$p})]})}function ht(s){const{task:n,type:r}=s;function a(R){const l=n.segments[R];return{left:`${l.$x}px`,top:"0px",width:`${l.$w}px`,height:"100%"}}function c(R){if(!n.progress)return 0;const l=n.duration*n.progress/100,w=n.segments;let g=0,k=0,d=null;do{const $=w[k];k===R&&(g>l?d=0:d=Math.min((l-g)/$.duration,1)*100),g+=$.duration,k++}while(d===null&&k<w.length);return d||0}return o.jsx("div",{className:"wx-segments wx-GKbcLEGA",children:n.segments.map((R,l)=>o.jsxs("div",{className:`wx-segment wx-bar wx-${r} wx-GKbcLEGA`,"data-segment":l,style:a(l),children:[n.progress?o.jsx("div",{className:"wx-progress-wrapper",children:o.jsx("div",{className:"wx-progress-percent wx-GKbcLEGA",style:{width:`${c(l)}%`}})}):null,o.jsx("div",{className:"wx-content",children:R.text||""})]},l))})}function gt(s){const{readonly:n,taskTemplate:r,multiTaskRows:a=!1,rowMapping:c=null,marqueeSelect:R=!1}=s,l=e.useContext(Ae),[w,g]=y.useStoreWithCounter(l,"_tasks"),[k,d]=y.useStoreWithCounter(l,"_links"),$=y.useStore(l,"area"),z=y.useStore(l,"_scales"),E=y.useStore(l,"taskTypes"),_=y.useStore(l,"baselines"),[u,A]=y.useStoreWithCounter(l,"_selected"),X=y.useStore(l,"_scrollTask"),H=y.useStore(l,"criticalPath"),K=y.useStore(l,"tasks"),v=y.useStore(l,"schedule"),P=y.useStore(l,"splitTasks"),p=e.useMemo(()=>{if(!$||!Array.isArray(w))return[];const t=$.start??0,m=$.end??0;return w.slice(t,m).map(C=>({...C}))},[g,$]),O=y.useStore(l,"cellHeight"),Z=e.useMemo(()=>{if(!a||!c||!p.length)return p;const t=new Map,m=[];return w.forEach(C=>{const N=c.taskRows.get(C.id)??C.id;t.has(N)||(t.set(N,m.length),m.push(N))}),p.map(C=>{const N=c.taskRows.get(C.id)??C.id,D=t.get(N)??0;return{...C,$y:D*O,$y_base:C.$y_base!==void 0?D*O:void 0}})},[p,a,c,w,O]),se=e.useMemo(()=>z.lengthUnitWidth,[z]),Y=e.useRef(!1),[L,re]=e.useState(void 0),[b,T]=e.useState(null),I=e.useRef(null),[Q,oe]=e.useState(null),[J,ie]=e.useState(void 0),U=e.useRef(null),[f,G]=e.useState(0),[W,ee]=e.useState(null),[F,ne]=e.useState(null),ge=e.useRef(null),ye=e.useMemo(()=>{const t=ge.current;return!!(u.length&&t&&t.contains(document.activeElement))},[u,ge.current]),j=e.useMemo(()=>ye&&u[u.length-1]?.id,[ye,u]);e.useEffect(()=>{if(X&&ye&&X){const{id:t}=X,m=ge.current?.querySelector(`.wx-bar[data-id='${t}']`);m&&m.focus({preventScroll:!0})}},[X]),e.useEffect(()=>{const t=ge.current;if(t&&(G(t.offsetWidth||0),typeof ResizeObserver<"u")){const m=new ResizeObserver(C=>{C[0]&&G(C[0].contentRect.width)});return m.observe(t),()=>m.disconnect()}},[ge.current]);const V=e.useCallback(()=>{document.body.style.userSelect="none"},[]),fe=e.useCallback(()=>{document.body.style.userSelect=""},[]),ke=e.useCallback((t,m,C)=>{if(m.target.classList.contains("wx-line")||(C||(C=l.getTask(He(t))),C.type==="milestone"||C.type==="summary"))return"";const N=be.locate(m,"data-segment");N&&(t=N);const{left:D,width:te}=t.getBoundingClientRect(),le=(m.clientX-D)/te;let we=.2/(te>200?te/200:1);return le<we?"start":le>1-we?"end":""},[l]),Ce=e.useMemo(()=>{const t=new Map;if(!a||!c)return w.forEach(N=>{t.set(N.id,N.$y)}),t;const m=new Map,C=[];return w.forEach(N=>{const D=c.taskRows.get(N.id)??N.id;m.has(D)||(m.set(D,C.length),C.push(D))}),w.forEach(N=>{const D=c.taskRows.get(N.id)??N.id,te=m.get(D)??0;t.set(N.id,te*O)}),t},[w,a,c,O]),Te=e.useCallback(t=>{const m=ge.current;if(!m)return[];const C=m.parentElement?.scrollLeft||0,N=m.parentElement?.parentElement?.scrollTop||0,D=Math.min(t.startX,t.currentX),te=Math.max(t.startX,t.currentX),le=Math.min(t.startY,t.currentY),we=Math.max(t.startY,t.currentY);return w.filter(me=>{const $e=me.$x-C,Ne=me.$x+me.$w-C,Pe=(Ce.get(me.id)??me.$y)-N,Ee=Pe+me.$h;return $e<te&&Ne>D&&Pe<we&&Ee>le})},[w,Ce]),Se=e.useMemo(()=>new Set(u.map(t=>t.id)),[u,A]),Re=e.useCallback(t=>Se.has(t),[Se]),ce=e.useCallback((t,m)=>{const{clientX:C}=m,N=He(t),D=l.getTask(N),te=m.target.classList;if(!m.target.closest(".wx-delete-button")&&!n){if(te.contains("wx-progress-marker")){const{progress:le}=l.getTask(N);I.current={id:N,x:C,progress:le,dx:0,node:t,marker:m.target},m.target.classList.add("wx-progress-in-drag")}else{const le=ke(t,m,D)||"move",we={id:N,mode:le,x:C,dx:0,l:D.$x,w:D.$w};if(P&&D.segments?.length){const me=be.locate(m,"data-segment");me&&(we.segmentIndex=me.dataset.segment*1,de.extendDragOptions(D,we))}T(we)}V()}},[l,n,ke,V,P]),x=e.useCallback(t=>{if(t.button!==0)return;const m=be.locate(t);if(!m&&R&&!n){const C=ge.current;if(!C)return;const N=C.getBoundingClientRect(),D=t.clientX-N.left,te=t.clientY-N.top;ee({startX:D,startY:te,currentX:D,currentY:te,ctrlKey:t.ctrlKey||t.metaKey}),V();return}if(m){if(R&&!n&&u.length>1){const C=He(m);if(Re(C)){const N=t.target.classList;if(!N.contains("wx-link")&&!N.contains("wx-progress-marker")&&!t.target.closest(".wx-delete-button")){const D=l.getTask(C);if(!ke(m,t,D)){const le=new Map;u.forEach(we=>{const me=l.getTask(we.id);if(me){if(v?.auto&&me.type==="summary")return;le.set(we.id,{$x:me.$x,$w:me.$w,start:me.start,end:me.end})}}),ne({baseTaskId:C,startX:t.clientX,dx:0,originalPositions:le}),V();return}}}}ce(m,t)}},[ce,R,n,u,Re,l,ke,v,V]),B=e.useCallback(t=>{const m=be.locate(t);m&&(U.current=setTimeout(()=>{ie(!0),ce(m,t.touches[0])},300))},[ce]),ae=e.useCallback(t=>{oe(t&&{...k.find(m=>m.id===t)})},[k]),M=e.useCallback(()=>{if(W){const t=Te(W);W.ctrlKey?t.forEach(m=>{l.exec("select-task",{id:m.id,toggle:!0})}):(u.length>0&&l.exec("select-task",{id:null}),t.forEach((m,C)=>{l.exec("select-task",{id:m.id,toggle:C>0})})),ee(null),fe(),Y.current=!0;return}if(F){const{dx:t,originalPositions:m}=F,C=Math.round(t/se);if(C!==0){let N=!0;m.forEach((D,te)=>{const le=l.getTask(te);le&&(l.exec("update-task",{id:te,diff:C,task:{start:le.start,end:le.end},skipUndo:!N}),N=!1)}),Y.current=!0}else m.forEach((N,D)=>{l.exec("drag-task",{id:D,left:N.$x,width:N.$w,inProgress:!1})});ne(null),fe();return}if(I.current){const{dx:t,id:m,marker:C,value:N}=I.current;I.current=null,typeof N<"u"&&t&&l.exec("update-task",{id:m,task:{progress:N},inProgress:!1}),C.classList.remove("wx-progress-in-drag"),Y.current=!0,fe()}else if(b){const{id:t,mode:m,dx:C,l:N,w:D,start:te,segment:le,index:we}=b;if(T(null),te){const me=Math.round(C/se);if(!me)l.exec("drag-task",{id:t,width:D,left:N,inProgress:!1,...le&&{segmentIndex:we}});else{let $e={},Ne=l.getTask(t);le&&(Ne=Ne.segments[we]),m==="move"?($e.start=Ne.start,$e.end=Ne.end):$e[m]=Ne[m],l.exec("update-task",{id:t,diff:me,task:$e,...le&&{segmentIndex:we}})}Y.current=!0}fe()}},[l,fe,b,se,W,F,Te,u]),pe=e.useCallback((t,m)=>{const{clientX:C,clientY:N}=m;if(!n){if(W){const D=ge.current;if(!D)return;const te=D.getBoundingClientRect(),le=C-te.left,we=N-te.top;ee(me=>({...me,currentX:le,currentY:we}));return}if(F){const D=C-F.startX;F.originalPositions.forEach((te,le)=>{const we=te.$x+D;l.exec("drag-task",{id:le,left:we,width:te.$w,inProgress:!0})}),ne(te=>({...te,dx:D}));return}if(I.current){const{node:D,x:te,id:le}=I.current,we=I.current.dx=C-te,me=Math.round(we/D.offsetWidth*100);let $e=I.current.progress+me;I.current.value=$e=Math.min(Math.max(0,$e),100),l.exec("update-task",{id:le,task:{progress:$e},inProgress:!0})}else if(b){ae(null);const{mode:D,l:te,w:le,x:we,id:me,start:$e,segment:Ne,index:Ue}=b,Pe=l.getTask(me),Ee=C-we;if(!$e&&Math.abs(Ee)<20||D==="start"&&le-Ee<se||D==="end"&&le+Ee<se||D==="move"&&(Ee<0&&te+Ee<0||Ee>0&&te+le+Ee>f)||b.segment&&!de.isSegmentMoveAllowed(Pe,b))return;const qe={...b,dx:Ee};let We,_e;if(D==="start"?(We=te+Ee,_e=le-Ee):D==="end"?(We=te,_e=le+Ee):D==="move"&&(We=te+Ee,_e=le),l.exec("drag-task",{id:me,width:_e,left:We,inProgress:!0,...Ne&&{segmentIndex:Ue}}),!qe.start&&(D==="move"&&Pe.$x==te||D!=="move"&&Pe.$w==le)){Y.current=!0,M();return}qe.start=!0,T(qe)}else{const D=be.locate(t);if(D){const te=l.getTask(He(D)),we=be.locate(t,"data-segment")||D,me=ke(we,m,te);we.style.cursor=me&&!n?"col-resize":"pointer"}}}},[l,n,b,se,f,ke,ae,M,W,F]),Le=e.useCallback(t=>{pe(t,t)},[pe]),ze=e.useCallback(t=>{J?(t.preventDefault(),pe(t,t.touches[0])):U.current&&(clearTimeout(U.current),U.current=null)},[J,pe]),Ie=e.useCallback(()=>{M()},[M]),je=e.useCallback(()=>{ie(null),U.current&&(clearTimeout(U.current),U.current=null),M()},[M]);e.useEffect(()=>(window.addEventListener("mouseup",Ie),()=>{window.removeEventListener("mouseup",Ie)}),[Ie]);const Ge=e.useCallback(t=>{if(!n){const m=be.locateID(t.target);if(m&&!t.target.classList.contains("wx-link")){const C=be.locateID(t.target,"data-segment");l.exec("show-editor",{id:m,...C!==null&&{segmentIndex:C}})}}},[l,n]),Ye=["e2s","s2s","e2e","s2e"],i=e.useCallback((t,m)=>Ye[(t?1:0)+(m?0:2)],[]),h=e.useCallback((t,m)=>{const C=L.id,N=L.start;return t===C?!0:!!k.find(D=>D.target==t&&D.source==C&&D.type===i(N,m))},[L,d,i]),S=e.useCallback(()=>{L&&re(null)},[L]),q=e.useCallback(t=>{if(Y.current){Y.current=!1;return}const m=be.locateID(t.target);if(m){const C=t.target.classList;if(C.contains("wx-link")){const N=C.contains("wx-left");if(!L){re({id:m,start:N});return}L.id!==m&&!h(m,N)&&l.exec("add-link",{link:{source:L.id,target:m,type:i(L.start,N)}})}else if(C.contains("wx-delete-button-icon"))l.exec("delete-link",{id:Q.id}),oe(null);else{let N;const D=be.locate(t,"data-segment");D&&(N=D.dataset.segment*1),l.exec("select-task",{id:m,toggle:t.ctrlKey||t.metaKey,range:t.shiftKey,segmentIndex:N})}}S()},[l,L,d,Q,h,i,S]),xe=e.useCallback(t=>({left:`${t.$x}px`,top:`${t.$y}px`,width:`${t.$w}px`,height:`${t.$h}px`}),[]),ue=e.useCallback(t=>({left:`${t.$x_base}px`,top:`${t.$y_base}px`,width:`${t.$w_base}px`,height:`${t.$h_base}px`}),[]),ve=e.useCallback(t=>{if(J||U.current)return t.preventDefault(),!1},[J]),Me=e.useMemo(()=>E.map(t=>t.id),[E]),Ke=e.useCallback(t=>{let m=Me.includes(t)?t:"task";return["task","milestone","summary"].includes(t)||(m=`task ${m}`),m},[Me]),Ve=e.useCallback(t=>{l.exec(t.action,t.data)},[l]),Fe=e.useCallback(t=>H&&K.byId(t).$critical,[H,K]),Be=e.useCallback(t=>{if(v?.auto){const m=K.getSummaryId(t,!0),C=K.getSummaryId(L.id,!0);return L?.id&&!(Array.isArray(m)?m:[m]).includes(L.id)&&!(Array.isArray(C)?C:[C]).includes(t)}return L},[v,K,L]),Qe=e.useMemo(()=>{if(!W)return null;const t=Math.min(W.startX,W.currentX),m=Math.min(W.startY,W.currentY),C=Math.abs(W.currentX-W.startX),N=Math.abs(W.currentY-W.startY);return{left:`${t}px`,top:`${m}px`,width:`${C}px`,height:`${N}px`}},[W]);return o.jsxs("div",{className:"wx-GKbcLEGA wx-bars",style:{lineHeight:`${Z.length?Z[0].$h:0}px`},ref:ge,onContextMenu:ve,onMouseDown:x,onMouseMove:Le,onTouchStart:B,onTouchMove:ze,onTouchEnd:je,onClick:q,onDoubleClick:Ge,onDragStart:t=>(t.preventDefault(),!1),children:[o.jsx(mt,{onSelectLink:ae,selectedLink:Q,readonly:n}),Z.map(t=>{if(t.$skip&&t.$skip_baseline)return null;const m=`wx-bar wx-${Ke(t.type)}`+(J&&b&&t.id===b.id?" wx-touch":"")+(L&&L.id===t.id?" wx-selected":"")+(Se.has(t.id)?" wx-selected":"")+(Fe(t.id)?" wx-critical":"")+(t.$reorder?" wx-reorder-task":"")+(P&&t.segments?" wx-split":""),C="wx-link wx-left"+(L?" wx-visible":"")+(!L||!h(t.id,!0)&&Be(t.id)?" wx-target":"")+(L&&L.id===t.id&&L.start?" wx-selected":"")+(Fe(t.id)?" wx-critical":""),N="wx-link wx-right"+(L?" wx-visible":"")+(!L||!h(t.id,!1)&&Be(t.id)?" wx-target":"")+(L&&L.id===t.id&&!L.start?" wx-selected":"")+(Fe(t.id)?" wx-critical":"");return o.jsxs(e.Fragment,{children:[!t.$skip&&o.jsxs("div",{className:"wx-GKbcLEGA "+m,style:xe(t),"data-tooltip-id":t.id,"data-id":t.id,tabIndex:j===t.id?0:-1,children:[n?null:t.id===Q?.target&&Q?.type[2]==="s"?o.jsx(he.Button,{type:"danger",css:"wx-left wx-delete-button wx-delete-link",children:o.jsx("i",{className:"wxi-close wx-delete-button-icon"})}):o.jsx("div",{className:"wx-GKbcLEGA "+C,children:o.jsx("div",{className:"wx-GKbcLEGA wx-inner"})}),t.type!=="milestone"?o.jsxs(o.Fragment,{children:[t.progress&&!(P&&t.segments)?o.jsx("div",{className:"wx-GKbcLEGA wx-progress-wrapper",children:o.jsx("div",{className:"wx-GKbcLEGA wx-progress-percent",style:{width:`${t.progress}%`}})}):null,!n&&!(P&&t.segments)?o.jsx("div",{className:"wx-GKbcLEGA wx-progress-marker",style:{left:`calc(${t.progress}% - 10px)`},children:t.progress}):null,r?o.jsx(r,{data:t,api:l,onAction:Ve}):P&&t.segments?o.jsx(ht,{task:t,type:Ke(t.type)}):o.jsx("div",{className:"wx-GKbcLEGA wx-content",children:t.text||""})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"wx-GKbcLEGA wx-content"}),r?o.jsx(r,{data:t,api:l,onAction:Ve}):o.jsx("div",{className:"wx-GKbcLEGA wx-text-out",children:t.text})]}),n?null:t.id===Q?.target&&Q?.type[2]==="e"?o.jsx(he.Button,{type:"danger",css:"wx-right wx-delete-button wx-delete-link",children:o.jsx("i",{className:"wxi-close wx-delete-button-icon"})}):o.jsx("div",{className:"wx-GKbcLEGA "+N,children:o.jsx("div",{className:"wx-GKbcLEGA wx-inner"})})]}),_&&!t.$skip_baseline?o.jsx("div",{className:"wx-GKbcLEGA wx-baseline"+(t.type==="milestone"?" wx-milestone":""),style:ue(t)}):null]},t.id)}),W&&Qe&&o.jsx("div",{className:"wx-GKbcLEGA wx-marquee-selection",style:Qe})]})}function wt(s){const{highlightTime:n}=s,r=e.useContext(Ae),a=y.useStore(r,"_scales");return o.jsx("div",{className:"wx-ZkvhDKir wx-scale",style:{width:a.width},children:(a?.rows||[]).map((c,R)=>o.jsx("div",{className:"wx-ZkvhDKir wx-row",style:{height:`${c.height}px`},children:(c.cells||[]).map((l,w)=>{const g=n?n(l.date,l.unit):"",k="wx-cell "+(l.css||"")+" "+(g||"");return o.jsx("div",{className:"wx-ZkvhDKir "+k,style:{width:`${l.width}px`},children:l.value},w)})},R))})}const pt=new Map;function bt(s){const n=e.useRef(null),r=e.useRef(0),a=e.useRef(null),c=typeof window<"u"&&window.__RENDER_METRICS_ENABLED__;n.current===null&&(n.current=performance.now()),r.current++,e.useEffect(()=>{if(c)return cancelAnimationFrame(a.current),a.current=requestAnimationFrame(()=>{const R={label:s,time:performance.now()-n.current,renders:r.current,timestamp:Date.now()};pt.set(s,R),window.dispatchEvent(new CustomEvent("render-metric",{detail:R}))}),()=>cancelAnimationFrame(a.current)})}function kt(s){const{readonly:n,fullWidth:r,fullHeight:a,taskTemplate:c,cellBorders:R,highlightTime:l,multiTaskRows:w=!1,rowMapping:g=null,marqueeSelect:k=!1}=s,d=e.useContext(Ae),[$,z]=y.useStoreWithCounter(d,"_selected"),E=y.useStore(d,"scrollTop"),_=y.useStore(d,"cellHeight"),u=y.useStore(d,"cellWidth"),A=y.useStore(d,"_scales"),X=y.useStore(d,"_markers"),H=y.useStore(d,"_scrollTask"),K=y.useStore(d,"zoom"),v=y.useStore(d,"_tasks"),[P,p]=e.useState(),O=e.useRef(null),Z=1+(A?.rows?.length||0),se=e.useMemo(()=>{if(!w||!g||!v?.length)return null;const f=new Map,G=new Map,W=[];return v.forEach(ee=>{const F=g.taskRows.get(ee.id)??ee.id;G.has(F)||(G.set(F,W.length),W.push(F))}),v.forEach(ee=>{const F=g.taskRows.get(ee.id)??ee.id,ne=G.get(F)??0;f.set(ee.id,ne*_)}),f},[v,w,g,_]),Y=e.useMemo(()=>{const f=[];return $&&$.length&&_&&$.forEach(G=>{const W=se?.get(G.id)??G.$y;f.push({height:`${_}px`,top:`${W-3}px`})}),f},[z,_,se]),L=e.useMemo(()=>Math.max(P||0,a),[P,a]);e.useEffect(()=>{const f=O.current;f&&typeof E=="number"&&(f.scrollTop=E)},[E]);const re=()=>{b()};function b(f){const G=O.current;if(!G)return;const W={};W.left=G.scrollLeft,d.exec("scroll-chart",W)}function T(){const f=O.current,W=Math.ceil((P||0)/(_||1))+1,ee=Math.floor((f&&f.scrollTop||0)/(_||1)),F=Math.max(0,ee-Z),ne=ee+W+Z,ge=F*(_||0);d.exec("render-data",{start:F,end:ne,from:ge})}e.useEffect(()=>{T()},[P,E]);const I=e.useCallback(f=>{if(!f)return;const{id:G,mode:W}=f;if(W.toString().indexOf("x")<0)return;const ee=O.current;if(!ee)return;const{clientWidth:F}=ee,ne=d.getTask(G);if(ne.$x+ne.$w<ee.scrollLeft)d.exec("scroll-chart",{left:ne.$x-(u||0)}),ee.scrollLeft=ne.$x-(u||0);else if(ne.$x>=F+ee.scrollLeft){const ge=F<ne.$w?u||0:ne.$w;d.exec("scroll-chart",{left:ne.$x-F+ge}),ee.scrollLeft=ne.$x-F+ge}},[d,u]);e.useEffect(()=>{I(H)},[H]);function Q(f){if(K&&(f.ctrlKey||f.metaKey)){f.preventDefault();const G=O.current,W=-Math.sign(f.deltaY),ee=f.clientX-(G?G.getBoundingClientRect().left:0);d.exec("zoom-scale",{dir:W,offset:ee})}}function oe(f){const G=l(f.date,f.unit);return G?{css:G,width:f.width}:null}const J=e.useMemo(()=>A&&(A.minUnit==="hour"||A.minUnit==="day")&&l?A.rows[A.rows.length-1].cells.map(oe):null,[A,l]),ie=e.useCallback(f=>{f.eventSource="chart",d.exec("hotkey",f)},[d]);e.useEffect(()=>{const f=O.current;if(!f)return;const G=()=>p(f.clientHeight);G();const W=new ResizeObserver(()=>G());return W.observe(f),()=>{W.disconnect()}},[O.current]);const U=e.useRef(null);return e.useEffect(()=>{const f=O.current;if(f&&!U.current)return U.current=st.hotkeys(f,{keys:{arrowup:!0,arrowdown:!0},exec:G=>ie(G)}),()=>{U.current?.destroy(),U.current=null}},[]),e.useEffect(()=>{const f=O.current;if(!f)return;const G=Q;return f.addEventListener("wheel",G),()=>{f.removeEventListener("wheel",G)}},[Q]),bt("chart"),o.jsxs("div",{className:"wx-mR7v2Xag wx-chart",tabIndex:-1,ref:O,onScroll:re,children:[o.jsx(wt,{highlightTime:l,scales:A}),X&&X.length?o.jsx("div",{className:"wx-mR7v2Xag wx-markers",style:{height:`${L}px`},children:X.map((f,G)=>o.jsx("div",{className:`wx-mR7v2Xag wx-marker ${f.css||""}`,style:{left:`${f.left}px`},children:o.jsx("div",{className:"wx-mR7v2Xag wx-content",children:f.text})},G))}):null,o.jsxs("div",{className:"wx-mR7v2Xag wx-area",style:{width:`${r}px`,height:`${L}px`},children:[J?o.jsx("div",{className:"wx-mR7v2Xag wx-gantt-holidays",style:{height:"100%"},children:J.map((f,G)=>f?o.jsx("div",{className:"wx-mR7v2Xag "+f.css,style:{width:`${f.width}px`,left:`${G*f.width}px`}},G):null)}):null,o.jsx(xt,{borders:R}),$&&$.length?$.map((f,G)=>f.$y?o.jsx("div",{className:"wx-mR7v2Xag wx-selected","data-id":f.id,style:Y[G]},f.id):null):null,o.jsx(gt,{readonly:n,taskTemplate:c,multiTaskRows:w,rowMapping:g,marqueeSelect:k})]})]})}function yt(s){const{position:n="after",size:r=4,dir:a="x",onMove:c,onDisplayChange:R,compactMode:l,containerWidth:w=0,leftThreshold:g=50,rightThreshold:k=50}=s,[d,$]=y.useWritableProp(s.value??0),[z,E]=y.useWritableProp(s.display??"all");function _(J){let ie=0;n=="center"?ie=r/2:n=="before"&&(ie=r);const U={size:[r+"px","auto"],p:[J-ie+"px","0px"],p2:["auto","0px"]};if(a!="x")for(let f in U)U[f]=U[f].reverse();return U}const[u,A]=e.useState(!1),[X,H]=e.useState(null),K=e.useRef(0),v=e.useRef(),P=e.useRef(),p=e.useRef(z);e.useEffect(()=>{p.current=z},[z]),e.useEffect(()=>{X===null&&d>0&&H(d)},[X,d]);function O(J){return a=="x"?J.clientX:J.clientY}const Z=e.useCallback(J=>{const ie=v.current+O(J)-K.current;$(ie);let U;ie<=g?U="chart":w-ie<=k?U="grid":U="all",p.current!==U&&(E(U),p.current=U),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>c&&c(ie),100)},[w,g,k,c]),se=e.useCallback(()=>{document.body.style.cursor="",document.body.style.userSelect="",A(!1),window.removeEventListener("mousemove",Z),window.removeEventListener("mouseup",se)},[Z]),Y=e.useMemo(()=>z!=="all"?"auto":a=="x"?"ew-resize":"ns-resize",[z,a]),L=e.useCallback(J=>{!l&&(z==="grid"||z==="chart")||(K.current=O(J),v.current=d,A(!0),document.body.style.cursor=Y,document.body.style.userSelect="none",window.addEventListener("mousemove",Z),window.addEventListener("mouseup",se))},[Y,Z,se,d,l,z]);function re(){E("all"),X!==null&&($(X),c&&c(X))}function b(J){if(l){const ie=z==="chart"?"grid":"chart";E(ie),R(ie)}else if(z==="grid"||z==="chart")re(),R("all");else{const ie=J==="left"?"chart":"grid";E(ie),R(ie)}}function T(){b("left")}function I(){b("right")}const Q=e.useMemo(()=>_(d),[d,n,r,a]),oe=["wx-resizer",`wx-resizer-${a}`,`wx-resizer-display-${z}`,u?"wx-resizer-active":""].filter(Boolean).join(" ");return o.jsxs("div",{className:"wx-pFykzMlT "+oe,onMouseDown:L,style:{width:Q.size[0],height:Q.size[1],cursor:Y},children:[o.jsxs("div",{className:"wx-pFykzMlT wx-button-expand-box",children:[o.jsx("div",{className:"wx-pFykzMlT wx-button-expand-content wx-button-expand-left",children:o.jsx("i",{className:"wx-pFykzMlT wxi-menu-left",onClick:T})}),o.jsx("div",{className:"wx-pFykzMlT wx-button-expand-content wx-button-expand-right",children:o.jsx("i",{className:"wx-pFykzMlT wxi-menu-right",onClick:I})})]}),o.jsx("div",{className:"wx-pFykzMlT wx-resizer-line"})]})}const vt=650;function rt(s){let n;function r(){n=new ResizeObserver(c=>{for(let R of c)if(R.target===document.body){let l=R.contentRect.width<=vt;s(l)}}),n.observe(document.body)}function a(){n&&(n.disconnect(),n=null)}return{observe:r,disconnect:a}}function Tt(s){const{taskTemplate:n,readonly:r,cellBorders:a,highlightTime:c,onTableAPIChange:R,multiTaskRows:l=!1,rowMapping:w=null,marqueeSelect:g=!1}=s,k=e.useContext(Ae),d=y.useStore(k,"_tasks"),$=y.useStore(k,"_scales"),z=y.useStore(k,"cellHeight"),E=y.useStore(k,"columns"),_=y.useStore(k,"_scrollTask"),u=y.useStore(k,"undo"),[A,X]=e.useState(!1);let[H,K]=e.useState(0);const[v,P]=e.useState(0),[p,O]=e.useState(0),[Z,se]=e.useState(void 0),[Y,L]=e.useState("all"),re=e.useRef(null),b=e.useCallback(j=>{X(V=>(j!==V&&(j?(re.current=Y,Y==="all"&&L("grid")):(!re.current||re.current==="all")&&L("all")),j))},[Y]);e.useEffect(()=>{const j=rt(b);return j.observe(),()=>{j.disconnect()}},[b]);const T=e.useMemo(()=>{let j;return E.every(V=>V.width&&!V.flexgrow)?j=E.reduce((V,fe)=>V+parseInt(fe.width),0):A&&Y==="chart"?j=parseInt(E.find(V=>V.id==="action")?.width)||50:j=440,H=j,j},[E,A,Y]);e.useEffect(()=>{K(T)},[T]);const I=e.useMemo(()=>(v??0)-(Z??0),[v,Z]),Q=e.useMemo(()=>$.width,[$]),oe=e.useMemo(()=>{if(!l||!w)return d.length*z;const j=new Set;return d.forEach(V=>{const fe=w.taskRows.get(V.id)??V.id;j.add(fe)}),j.size*z},[d,z,l,w]),J=e.useMemo(()=>$.height+oe+I,[$,oe,I]),ie=e.useMemo(()=>H+Q,[H,Q]),U=e.useRef(null),f=e.useCallback(()=>{Promise.resolve().then(()=>{if((v??0)>(ie??0)){const j=(v??0)-H;k.exec("expand-scale",{minWidth:j})}})},[v,ie,H,k]);e.useEffect(()=>{let j;return U.current&&(j=new ResizeObserver(f),j.observe(U.current)),()=>{j&&j.disconnect()}},[U.current,f]),e.useEffect(()=>{f()},[Q]);const G=e.useRef(null),W=e.useRef(null),ee=e.useCallback(()=>{const j=G.current;j&&k.exec("scroll-chart",{top:j.scrollTop})},[k]),F=e.useRef({rTasks:[],rScales:{height:0},rCellHeight:0,scrollSize:0,ganttDiv:null,ganttHeight:0});e.useEffect(()=>{F.current={rTasks:d,rScales:$,rCellHeight:z,scrollSize:I,ganttDiv:G.current,ganttHeight:p??0}},[d,$,z,I,p]);const ne=e.useCallback(j=>{if(!j)return;const{rTasks:V,rScales:fe,rCellHeight:ke,scrollSize:Ce,ganttDiv:Te,ganttHeight:Se}=F.current;if(!Te)return;const{id:Re}=j,ce=V.findIndex(x=>x.id===Re);if(ce>-1){const x=Se-fe.height,B=ce*ke,ae=Te.scrollTop;let M=null;B<ae?M=B:B+ke>ae+x&&(M=B-x+ke+Ce),M!==null&&(k.exec("scroll-chart",{top:Math.max(M,0)}),G.current.scrollTop=Math.max(M,0))}},[k]);e.useEffect(()=>{ne(_)},[_]),e.useEffect(()=>{const j=G.current,V=W.current;if(!j||!V)return;const fe=()=>{ct.flushSync(()=>{O(j.offsetHeight),P(j.offsetWidth),se(V.offsetWidth)})},ke=new ResizeObserver(fe);return ke.observe(j),()=>ke.disconnect()},[G.current]);const ge=e.useRef(null),ye=e.useRef(null);return e.useEffect(()=>{ye.current&&(ye.current.destroy(),ye.current=null);const j=ge.current;if(j)return ye.current=st.hotkeys(j,{keys:{"ctrl+c":!0,"ctrl+v":!0,"ctrl+x":!0,"ctrl+d":!0,"meta+c":!0,"meta+v":!0,"meta+x":!0,"meta+d":!0,backspace:!0,"ctrl+z":u,"ctrl+y":u,"meta+z":u,"meta+shift+z":u},exec:V=>{V.isInput||k.exec("hotkey",V)}}),()=>{ye.current?.destroy(),ye.current=null}},[u]),o.jsx("div",{className:"wx-jlbQoHOz wx-gantt",ref:G,onScroll:ee,children:o.jsx("div",{className:"wx-jlbQoHOz wx-pseudo-rows",style:{height:J,width:"100%"},ref:W,children:o.jsx("div",{className:"wx-jlbQoHOz wx-stuck",style:{height:p,width:Z},children:o.jsxs("div",{tabIndex:0,className:"wx-jlbQoHOz wx-layout",ref:ge,children:[E.length?o.jsxs(o.Fragment,{children:[o.jsx(ft,{display:Y,compactMode:A,columnWidth:T,width:H,readonly:r,fullHeight:oe,onTableAPIChange:R,multiTaskRows:l,rowMapping:w}),o.jsx(yt,{value:H,display:Y,compactMode:A,containerWidth:v,onMove:j=>K(j),onDisplayChange:j=>L(j)})]}):null,o.jsx("div",{className:"wx-jlbQoHOz wx-content",ref:U,children:o.jsx(kt,{readonly:r,fullWidth:Q,fullHeight:oe,taskTemplate:n,cellBorders:a,highlightTime:c,multiTaskRows:l,rowMapping:w,marqueeSelect:g})})]})})})})}function Ct(s){return{year:"%Y",quarter:`${s("Q")} %Q`,month:"%M",week:`${s("Week")} %w`,day:"%M %j",hour:"%H:%i"}}function St(s,n){return typeof s=="function"?s:be.dateToString(s,n)}function ot(s,n){return s.map(({format:r,...a})=>({...a,format:St(r,n)}))}function Mt(s,n){const r=Ct(n);for(let a in r)r[a]=be.dateToString(r[a],s);return r}function Et(s,n){if(!s||!s.length)return s;const r=be.dateToString("%d-%m-%Y",n);return s.map(a=>a.template?a:a.id==="start"||a.id=="end"?{...a,_template:c=>r(c),template:c=>r(c)}:a.id==="duration"?{...a,_template:c=>c,template:c=>c}:a)}function Rt(s,n){return s.levels?{...s,levels:s.levels.map(r=>({...r,scales:ot(r.scales,n)}))}:s}const jt=s=>s.split("-").map(n=>n?n.charAt(0).toUpperCase()+n.slice(1):"").join(""),$t=[{unit:"month",step:1,format:"%F %Y"},{unit:"day",step:1,format:"%j"}],Lt=e.forwardRef(function({taskTemplate:n=null,markers:r=[],taskTypes:a=de.defaultTaskTypes,tasks:c=[],selected:R=[],activeTask:l=null,links:w=[],scales:g=$t,columns:k=de.defaultColumns,start:d=null,end:$=null,lengthUnit:z="day",durationUnit:E="day",cellWidth:_=100,cellHeight:u=38,scaleHeight:A=36,readonly:X=!1,cellBorders:H="full",zoom:K=!1,baselines:v=!1,highlightTime:P=null,init:p=null,autoScale:O=!0,unscheduledTasks:Z=!1,criticalPath:se=null,schedule:Y={type:"forward"},projectStart:L=null,projectEnd:re=null,calendar:b=null,undo:T=!1,splitTasks:I=!1,multiTaskRows:Q=!1,marqueeSelect:oe=!1,...J},ie){const U=e.useRef();U.current=J;const f=e.useMemo(()=>new de.DataStore(y.writable),[]),G=e.useMemo(()=>({...Xe.en,...Oe.en}),[]),W=e.useContext(he.context.i18n),ee=e.useMemo(()=>W?W.extend(G,!0):be.locale(G),[W,G]),F=e.useMemo(()=>ee.getRaw().calendar,[ee]),ne=e.useMemo(()=>{let ce={zoom:Rt(K,F),scales:ot(g,F),columns:Et(k,F),links:de.normalizeLinks(w),cellWidth:_};return ce.zoom&&(ce={...ce,...de.normalizeZoom(ce.zoom,Mt(F,ee.getGroup("gantt")),ce.scales,_)}),ce},[K,g,k,w,_,F,ee]),ge=e.useRef(null);ge.current!==c&&(de.parseTaskDates(c,{durationUnit:E,splitTasks:I,calendar:b}),ge.current=c),e.useEffect(()=>{de.parseTaskDates(c,{durationUnit:E,splitTasks:I,calendar:b})},[c,E,b,I]);const ye=e.useMemo(()=>{if(!Q)return null;const ce=new Map,x=new Map,B=ae=>{ae.forEach(M=>{const pe=M.row??M.id;x.set(M.id,pe),ce.has(pe)||ce.set(pe,[]),ce.get(pe).push(M.id),M.data&&M.data.length>0&&B(M.data)})};return B(c),{rowMap:ce,taskRows:x}},[c,Q]),j=e.useMemo(()=>f.in,[f]),V=e.useRef(null);V.current===null&&(V.current=new lt.EventBusRouter((ce,x)=>{const B="on"+jt(ce);U.current&&U.current[B]&&U.current[B](x)}),j.setNext(V.current));const[fe,ke]=e.useState(null),Ce=e.useRef(null);Ce.current=fe;const Te=e.useMemo(()=>({getState:f.getState.bind(f),getReactiveState:f.getReactive.bind(f),getStores:()=>({data:f}),exec:j.exec,setNext:ce=>(V.current=V.current.setNext(ce),V.current),intercept:j.intercept.bind(j),on:j.on.bind(j),detach:j.detach.bind(j),getTask:f.getTask.bind(f),serialize:f.serialize.bind(f),getTable:ce=>ce?new Promise(x=>setTimeout(()=>x(Ce.current),1)):Ce.current,getHistory:()=>f.getHistory()}),[f,j]);e.useImperativeHandle(ie,()=>({...Te}),[Te]);const Se=e.useRef(0);e.useEffect(()=>{Se.current?f.init({tasks:c,links:ne.links,start:d,columns:ne.columns,end:$,lengthUnit:z,cellWidth:ne.cellWidth,cellHeight:u,scaleHeight:A,scales:ne.scales,taskTypes:a,zoom:ne.zoom,selected:R,activeTask:l,baselines:v,autoScale:O,unscheduledTasks:Z,markers:r,durationUnit:E,criticalPath:se,schedule:Y,projectStart:L,projectEnd:re,calendar:b,undo:T,_weekStart:F.weekStart,splitTasks:I}):p&&p(Te),Se.current++},[Te,p,c,ne,d,$,z,u,A,a,R,l,v,O,Z,r,E,se,Y,L,re,b,T,F,I,f]),Se.current===0&&f.init({tasks:c,links:ne.links,start:d,columns:ne.columns,end:$,lengthUnit:z,cellWidth:ne.cellWidth,cellHeight:u,scaleHeight:A,scales:ne.scales,taskTypes:a,zoom:ne.zoom,selected:R,activeTask:l,baselines:v,autoScale:O,unscheduledTasks:Z,markers:r,durationUnit:E,criticalPath:se,schedule:Y,projectStart:L,projectEnd:re,calendar:b,undo:T,_weekStart:F.weekStart,splitTasks:I});const Re=e.useMemo(()=>b?(ce,x)=>x=="day"&&!b.getDayHours(ce)||x=="hour"&&!b.getDayHours(ce)?"wx-weekend":"":P,[b,P]);return o.jsx(he.context.i18n.Provider,{value:ee,children:o.jsx(Ae.Provider,{value:Te,children:o.jsx(Tt,{taskTemplate:n,readonly:X,cellBorders:H,highlightTime:Re,onTableAPIChange:ke,multiTaskRows:Q,rowMapping:ye,marqueeSelect:oe})})})});function Nt({api:s=null,items:n=[]}){const r=e.useContext(he.context.i18n),a=e.useMemo(()=>r||be.locale(Oe.en),[r]),c=e.useMemo(()=>a.getGroup("gantt"),[a]),R=y.useStoreLater(s,"_selected"),l=y.useStoreLater(s,"undo"),w=y.useStoreLater(s,"history"),g=y.useStoreLater(s,"splitTasks"),k=["undo","redo"],d=e.useMemo(()=>{const z=de.getToolbarButtons({undo:!0,splitTasks:!0});return(n.length?n:de.getToolbarButtons({undo:l,splitTasks:g})).map(_=>{let u={..._,disabled:!1};return u.handler=de.isHandledAction(z,u.id)?A=>de.handleAction(s,A.id,null,c):u.handler,u.text&&(u.text=c(u.text)),u.menuText&&(u.menuText=c(u.menuText)),u})},[n,s,c,l,g]),$=e.useMemo(()=>{const z=[];return d.forEach(E=>{const _=E.id;if(_==="add-task")z.push(E);else if(k.includes(_))k.includes(_)&&z.push({...E,disabled:E.isDisabled(w)});else{if(!R?.length||!s)return;z.push({...E,disabled:E.isDisabled&&R.some(u=>E.isDisabled(u,s.getState()))})}}),z.filter((E,_)=>{if(s&&E.isHidden)return!R.some(u=>E.isHidden(u,s.getState()));if(E.comp==="separator"){const u=z[_+1];if(!u||u.comp==="separator")return!1}return!0})},[s,R,w,d]);return r?o.jsx(Ze.Toolbar,{items:$}):o.jsx(he.context.i18n.Provider,{value:a,children:o.jsx(Ze.Toolbar,{items:$})})}const It=e.forwardRef(function({options:n=[],api:r=null,resolver:a=null,filter:c=null,at:R="point",children:l,onClick:w,css:g},k){const d=e.useRef(null),$=e.useRef(null),z=e.useContext(he.context.i18n),E=e.useMemo(()=>z||be.locale({...Oe.en,...Xe.en}),[z]),_=e.useMemo(()=>E.getGroup("gantt"),[E]),u=y.useStoreLater(r,"taskTypes"),A=y.useStoreLater(r,"selected"),X=y.useStoreLater(r,"_selected"),H=y.useStoreLater(r,"splitTasks"),K=e.useMemo(()=>de.getMenuOptions({splitTasks:!0}),[]);e.useEffect(()=>{r&&(r.on("scroll-chart",()=>{d.current&&d.current.show&&d.current.show()}),r.on("drag-task",()=>{d.current&&d.current.show&&d.current.show()}))},[r]);function v(b){return b.map(T=>(T={...T},T.text&&(T.text=_(T.text)),T.subtext&&(T.subtext=_(T.subtext)),T.data&&(T.data=v(T.data)),T))}function P(){const b=n.length?n:de.getMenuOptions({splitTasks:H}),T=b.find(I=>I.id==="convert-task");return T&&(T.data=[],(u||[]).forEach(I=>{T.data.push(T.dataFactory(I))})),v(b)}const p=e.useMemo(()=>P(),[r,n,u,H,_]),O=e.useMemo(()=>X&&X.length?X:[],[X]),Z=e.useCallback((b,T)=>{let I=b?r?.getTask(b):null;if(a){const Q=a(b,T);I=Q===!0?I:Q}if(I){const Q=be.locateID(T.target,"data-segment");Q!==null?$.current={id:I.id,segmentIndex:Q}:$.current=I.id,(!Array.isArray(A)||!A.includes(I.id))&&r&&r.exec&&r.exec("select-task",{id:I.id})}return I},[r,a,A]),se=e.useCallback(b=>{const T=b.action;T&&(de.isHandledAction(K,T.id)&&de.handleAction(r,T.id,$.current,_),w&&w(b))},[r,_,w,K]),Y=e.useCallback((b,T)=>{const I=O.length?O:T?[T]:[];let Q=c?I.every(oe=>c(b,oe)):!0;if(Q&&(b.isHidden&&(Q=!I.some(oe=>b.isHidden(oe,r.getState(),$.current))),b.isDisabled)){const oe=I.some(J=>b.isDisabled(J,r.getState(),$.current));b.disabled=oe}return Q},[c,O,r]);e.useImperativeHandle(k,()=>({show:(b,T)=>{d.current&&d.current.show&&d.current.show(b,T)}}));const L=e.useCallback(b=>{d.current&&d.current.show&&d.current.show(b)},[]),re=o.jsxs(o.Fragment,{children:[o.jsx(it.ContextMenu,{filter:Y,options:p,dataKey:"id",resolver:Z,onClick:se,at:R,ref:d,css:g}),o.jsx("span",{onContextMenu:L,"data-menu-ignore":"true",children:typeof l=="function"?l():l})]});if(!z&&he.context.i18n?.Provider){const b=he.context.i18n.Provider;return o.jsx(b,{value:E,children:re})}return re});function Dt({api:s,autoSave:n,onLinksChange:r}){const c=e.useContext(he.context.i18n).getGroup("gantt"),R=y.useStore(s,"activeTask"),l=y.useStore(s,"_activeTask"),w=y.useStore(s,"_links"),g=y.useStore(s,"schedule"),k=y.useStore(s,"unscheduledTasks"),[d,$]=e.useState();function z(){if(R){const A=w.filter(H=>H.target==R).map(H=>({link:H,task:s.getTask(H.source)})),X=w.filter(H=>H.source==R).map(H=>({link:H,task:s.getTask(H.target)}));return[{title:c("Predecessors"),data:A},{title:c("Successors"),data:X}]}}e.useEffect(()=>{$(z())},[R,w]);const E=e.useMemo(()=>[{id:"e2s",label:c("End-to-start")},{id:"s2s",label:c("Start-to-start")},{id:"e2e",label:c("End-to-end")},{id:"s2e",label:c("Start-to-end")}],[c]);function _(A){n?s.exec("delete-link",{id:A}):($(X=>(X||[]).map(H=>({...H,data:H.data.filter(K=>K.link.id!==A)}))),r&&r({id:A,action:"delete-link",data:{id:A}}))}function u(A,X){n?s.exec("update-link",{id:A,link:X}):($(H=>(H||[]).map(K=>({...K,data:K.data.map(v=>v.link.id===A?{...v,link:{...v.link,...X}}:v)}))),r&&r({id:A,action:"update-link",data:{id:A,link:X}}))}return o.jsx(o.Fragment,{children:(d||[]).map((A,X)=>A.data.length?o.jsx("div",{className:"wx-j93aYGQf wx-links",children:o.jsx(he.Field,{label:A.title,position:"top",children:o.jsx("table",{children:o.jsx("tbody",{children:A.data.map(H=>o.jsxs("tr",{children:[o.jsx("td",{className:"wx-j93aYGQf wx-cell",children:o.jsx("div",{className:"wx-j93aYGQf wx-task-name",children:H.task.text||""})}),g?.auto&&H.link.type==="e2s"?o.jsx("td",{className:"wx-j93aYGQf wx-cell wx-link-lag",children:o.jsx(he.Text,{type:"number",placeholder:c("Lag"),value:H.link.lag,disabled:k&&l?.unscheduled,onChange:K=>{K.input||u(H.link.id,{lag:K.value})}})}):null,o.jsx("td",{className:"wx-j93aYGQf wx-cell",children:o.jsx("div",{className:"wx-j93aYGQf wx-wrapper",children:o.jsx(he.Combo,{value:H.link.type,placeholder:c("Select link type"),options:E,onChange:K=>u(H.link.id,{type:K.value}),children:({option:K})=>K.label})})}),o.jsx("td",{className:"wx-j93aYGQf wx-cell",children:o.jsx("i",{className:"wx-j93aYGQf wxi-delete wx-delete-icon",onClick:()=>_(H.link.id),role:"button"})})]},H.link.id))})})})},X):null)})}function At(s){const{value:n,time:r,format:a,onchange:c,onChange:R,...l}=s,w=R??c;function g(k){const d=new Date(k.value);d.setHours(n.getHours()),d.setMinutes(n.getMinutes()),w&&w({value:d})}return o.jsxs("div",{className:"wx-hFsbgDln date-time-controll",children:[o.jsx(he.DatePicker,{...l,value:n,onChange:g,format:a,buttons:["today"],clear:!1}),r?o.jsx(he.TimePicker,{value:n,onChange:w,format:a}):null]})}De.registerEditorItem("select",he.RichSelect);De.registerEditorItem("date",At);De.registerEditorItem("twostate",he.TwoState);De.registerEditorItem("slider",he.Slider);De.registerEditorItem("counter",he.Counter);De.registerEditorItem("links",Dt);function Ht({api:s,items:n=[],css:r="",layout:a="default",readonly:c=!1,placement:R="sidebar",bottomBar:l=!0,topBar:w=!0,autoSave:g=!0,focus:k=!1,hotkeys:d={}}){const $=e.useContext(he.context.i18n),z=e.useMemo(()=>$||be.locale({...Oe.en,...Xe.en}),[$]),E=e.useMemo(()=>z.getGroup("gantt"),[z]),_=z.getRaw(),u=e.useMemo(()=>{const x=_.gantt?.dateFormat||_.formats?.dateFormat;return be.dateToString(x,_.calendar)},[_]),A=e.useMemo(()=>{if(w===!0&&!c){const x=[{comp:"icon",icon:"wxi-close",id:"close"},{comp:"spacer"},{comp:"button",type:"danger",text:E("Delete"),id:"delete"}];return g?{items:x}:{items:[...x,{comp:"button",type:"primary",text:E("Save"),id:"save"}]}}return w},[w,c,g,E]),[X,H]=e.useState(!1),K=e.useMemo(()=>X?"wx-full-screen":"",[X]),v=e.useCallback(x=>{H(x)},[]);e.useEffect(()=>{const x=rt(v);return x.observe(),()=>{x.disconnect()}},[v]);const P=y.useStore(s,"_activeTask"),p=y.useStore(s,"activeTask"),O=y.useStore(s,"unscheduledTasks"),Z=y.useStore(s,"links"),se=y.useStore(s,"splitTasks"),Y=e.useMemo(()=>se&&p?.segmentIndex,[se,p]),L=e.useMemo(()=>Y||Y===0,[Y]),re=e.useMemo(()=>de.getEditorItems({unscheduledTasks:O}),[O]),b=y.useStore(s,"undo"),[T,I]=e.useState({}),[Q,oe]=e.useState(null),[J,ie]=e.useState(),[U,f]=e.useState(null),G=y.useStore(s,"taskTypes"),W=e.useMemo(()=>{if(!P)return null;let x;if(L&&P.segments?x={...P.segments[Y]}:x={...P},c){let B={parent:x.parent};return re.forEach(({key:ae,comp:M})=>{if(M!=="links"){const pe=x[ae];M==="date"&&pe instanceof Date?B[ae]=u(pe):M==="slider"&&ae==="progress"?B[ae]=`${pe}%`:B[ae]=pe}}),B}return x||null},[P,L,Y,c,re,u]);e.useEffect(()=>{ie(W)},[W]),e.useEffect(()=>{I({}),f(null),oe(null)},[p]);function ee(x,B){return x.map(ae=>{const M={...ae};if(ae.config&&(M.config={...M.config}),M.comp==="links"&&s&&(M.api=s,M.autoSave=g,M.onLinksChange=ge),M.comp==="select"&&M.key==="type"){const pe=M.options??(G||[]);M.options=pe.map(Le=>({...Le,label:E(Le.label)}))}return M.comp==="slider"&&M.key==="progress"&&(M.labelTemplate=pe=>`${E(M.label)} ${pe}%`),M.label&&(M.label=E(M.label)),M.config?.placeholder&&(M.config.placeholder=E(M.config.placeholder)),B&&(M.isDisabled&&M.isDisabled(B,s.getState())?M.disabled=!0:delete M.disabled),M})}const F=e.useMemo(()=>{let x=n.length?n:re;return x=ee(x,J),J?x.filter(B=>!B.isHidden||!B.isHidden(J,s.getState())):x},[n,re,J,G,E,s,g]),ne=e.useMemo(()=>F.map(x=>x.key),[F]);function ge({id:x,action:B,data:ae}){I(M=>({...M,[x]:{action:B,data:ae}}))}const ye=e.useCallback(()=>{for(let x in T)if(Z.byId(x)){const{action:B,data:ae}=T[x];s.exec(B,ae)}},[s,T,Z]),j=e.useCallback(()=>{const x=p?.id||p;if(L){if(P?.segments){const B=P.segments.filter((ae,M)=>M!==Y);s.exec("update-task",{id:x,task:{segments:B}})}}else s.exec("delete-task",{id:x})},[s,p,L,P,Y]),V=e.useCallback(()=>{s.exec("show-editor",{id:null})},[s]),fe=e.useCallback(x=>{const{item:B,changes:ae}=x;B.id==="delete"&&j(),B.id==="save"&&(ae.length?V():ye()),B.comp&&V()},[s,p,g,ye,j,V]),ke=e.useCallback((x,B,ae)=>(O&&x.type==="summary"&&(x.unscheduled=!1),de.prepareEditTask(x,s.getState(),B),ae||oe(!1),x),[O,s]),Ce=e.useCallback(x=>{x={...x,unscheduled:O&&x.unscheduled&&x.type!=="summary"},delete x.links,delete x.data,(ne.indexOf("duration")===-1||x.segments&&!x.duration)&&delete x.duration;const B={id:p?.id||p,task:x,...L&&{segmentIndex:Y}};g&&Q&&(B.inProgress=Q),s.exec("update-task",B),g||ye()},[s,p,O,g,ye,ne,L,Y,Q]),Te=e.useCallback(x=>{let{update:B,key:ae,input:M}=x;if(M&&oe(!0),x.update=ke({...B},ae,M),!g)ie(x.update);else if(!U&&!M){const pe=F.find(Ie=>Ie.key===ae),Le=B[ae];(!pe.validation||pe.validation(Le))&&(!pe.required||Le)&&Ce(x.update)}},[g,ke,U,F,Ce]),Se=e.useCallback(x=>{g||Ce(x.values)},[g,Ce]),Re=e.useCallback(x=>{f(x.errors)},[]),ce=e.useMemo(()=>b?{"ctrl+z":x=>{x.preventDefault(),s.exec("undo")},"ctrl+y":x=>{x.preventDefault(),s.exec("redo")}}:{},[b,s]);return W?o.jsx(he.Locale,{children:o.jsx(De.Editor,{css:`wx-XkvqDXuw wx-gantt-editor ${K} ${r}`,items:F,values:W,topBar:A,bottomBar:l,placement:R,layout:a,readonly:c,autoSave:g,focus:k,onAction:fe,onSave:Se,onValidation:Re,onChange:Te,hotkeys:d&&{...ce,...d}})}):null}const Pt=({children:s,columns:n=null,api:r})=>{const[a,c]=e.useState(null);return e.useEffect(()=>{r&&r.getTable(!0).then(c)},[r]),o.jsx(nt.HeaderMenu,{api:a,columns:n,children:s})};function zt(s){const{api:n,content:r,children:a}=s,c=e.useRef(null),R=e.useRef(null),[l,w]=e.useState({}),[g,k]=e.useState(null),[d,$]=e.useState({});function z(v){for(;v;){if(v.getAttribute){const P=v.getAttribute("data-tooltip-id"),p=v.getAttribute("data-tooltip-at"),O=v.getAttribute("data-tooltip");if(P||O)return{id:P,tooltip:O,target:v,at:p}}v=v.parentNode}return{id:null,tooltip:null,target:null,at:null}}e.useEffect(()=>{const v=R.current;if(v&&d&&(d.text||r)){const P=v.getBoundingClientRect();let p=!1,O=d.left,Z=d.top;P.right>=l.right&&(O=l.width-P.width-5,p=!0),P.bottom>=l.bottom&&(Z=d.top-(P.bottom-l.bottom+2),p=!0),p&&$(se=>se&&{...se,left:O,top:Z})}},[d,l,r]);const E=e.useRef(null),_=300,u=v=>{clearTimeout(E.current),E.current=setTimeout(()=>{v()},_)};function A(v){let{id:P,tooltip:p,target:O,at:Z}=z(v.target);if($(null),k(null),!p)if(P)p=H(P);else{clearTimeout(E.current);return}const se=v.clientX;u(()=>{P&&k(X(K(P)));const Y=O.getBoundingClientRect(),L=c.current,re=L?L.getBoundingClientRect():{top:0,left:0,right:0,bottom:0,width:0,height:0};let b,T;Z==="left"?(b=Y.top+5-re.top,T=Y.right+5-re.left):(b=Y.top+Y.height-re.top,T=se-re.left),w(re),$({top:b,left:T,text:p})})}function X(v){return n?.getTask(K(v))||null}function H(v){return X(v)?.text||""}function K(v){const P=parseInt(v);return isNaN(P)?v:P}return o.jsxs("div",{className:"wx-KG0Lwsqo wx-tooltip-area",ref:c,onMouseMove:A,children:[d&&(d.text||r)?o.jsx("div",{className:"wx-KG0Lwsqo wx-gantt-tooltip",ref:R,style:{top:`${d.top}px`,left:`${d.left}px`},children:r?o.jsx(r,{data:g}):d.text?o.jsx("div",{className:"wx-KG0Lwsqo wx-gantt-tooltip-text",children:d.text}):null}):null,a]})}function Gt({fonts:s=!0,children:n}){return n?o.jsx(he.Material,{fonts:s,children:n()}):o.jsx(he.Material,{fonts:s})}function Wt({fonts:s=!0,children:n}){return n?o.jsx(he.Willow,{fonts:s,children:n}):o.jsx(he.Willow,{fonts:s})}function _t({fonts:s=!0,children:n}){return n?o.jsx(he.WillowDark,{fonts:s,children:n}):o.jsx(he.WillowDark,{fonts:s})}Object.defineProperty(exports,"defaultColumns",{enumerable:!0,get:()=>de.defaultColumns});Object.defineProperty(exports,"defaultEditorItems",{enumerable:!0,get:()=>de.defaultEditorItems});Object.defineProperty(exports,"defaultMenuOptions",{enumerable:!0,get:()=>de.defaultMenuOptions});Object.defineProperty(exports,"defaultTaskTypes",{enumerable:!0,get:()=>de.defaultTaskTypes});Object.defineProperty(exports,"defaultToolbarButtons",{enumerable:!0,get:()=>de.defaultToolbarButtons});Object.defineProperty(exports,"getEditorItems",{enumerable:!0,get:()=>de.getEditorItems});Object.defineProperty(exports,"getMenuOptions",{enumerable:!0,get:()=>de.getMenuOptions});Object.defineProperty(exports,"getToolbarButtons",{enumerable:!0,get:()=>de.getToolbarButtons});Object.defineProperty(exports,"registerScaleUnit",{enumerable:!0,get:()=>de.registerScaleUnit});Object.defineProperty(exports,"registerEditorItem",{enumerable:!0,get:()=>De.registerEditorItem});exports.ContextMenu=It;exports.Editor=Ht;exports.Gantt=Lt;exports.HeaderMenu=Pt;exports.Material=Gt;exports.Toolbar=Nt;exports.Tooltip=zt;exports.Willow=Wt;exports.WillowDark=_t;
//# sourceMappingURL=index.cjs.map
